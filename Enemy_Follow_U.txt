extends CharacterBody2D

@export var speed: float = 100.0
@export var detection_range: float = 300.0
@onready var detection_area: Area2D = $DetectionArea

var player: Node2D = null
var is_following: bool = false



func _physics_process(delta: float) -> void:
	if is_following and player:
		follow_player(delta)

func follow_player(delta: float) -> void:
	var direction = (player.global_position - global_position).normalized()
	velocity.x = direction.x * speed

	# Make it only move horizontally (for a platformer)
	move_and_slide()

	# Optional: flip sprite depending on direction
	if direction.x != 0:
		$Sprite2D.flip_h = direction.x < 0

func _on_body_entered(body: Node) -> void:
	if body.is_in_group("Player"): # Make sure your player is in the "Player" group
		player = body
		is_following = true

func _on_body_exited(body: Node) -> void:
	if body == player:
		is_following = false
		player = null
		velocity = Vector2.ZERO
